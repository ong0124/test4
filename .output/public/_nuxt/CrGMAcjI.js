import{_ as me}from"./NLwD3dW4.js";import he from"./BoSwB06y.js";import{e as ve,D as fe,Y as ge,g as q,n as m,h as c,i as ye,j as be,o as r,c as _,a as e,b as i,t as s,k as n,l as D,w as v,F as J,z as M,p as Q,y as X}from"./DfY4Dsmv.js";import{d as b}from"./D8ZMcQSb.js";import{D as xe,S as ke,T as we,C as Be,l as Z,b as $e}from"./CKkcH8Nc.js";import{l as Te}from"./Dupr4v_f.js";const He={class:"py-4 border-b bg-green-400 flex items-center"},De={class:"absolute left-1/2 transform -translate-x-1/2 text-xl font-bold capitalize"},Me={class:"text-red-600 text-sm flex bg-yellow-300 pl-4"},Re={class:"px-6 pt-4"},Ue={class:"bg-amber-50 p-4 rounded-lg flex flex-col border-b-2 border-dashed"},Pe={class:"font-bold"},Ye={class:"text-gray-500"},Fe={class:"flex"},Ce={class:"flex-1 self-center"},Ne={class:"text-end"},Ae={class:"flex-1 flex-col text-center"},Se={class:"border-b-2 border-dashed mx-4 border-green-400 text-sm"},Ve={class:"text-sm"},Oe={class:"flex-1 self-center"},ze={class:"grid grid-cols-2 pt-4"},je={class:"flex-col text-end"},Ee={class:""},Ke={key:0},Ie={class:"bg-amber-50 p-4 rounded-lg flex flex-col border-b-2"},Le={class:"border-l-2 border-orange-400"},Ge={class:"mx-2"},We={class:"text-gray-500"},qe={class:"flex"},Je={class:"flex-1 self-center"},Qe={class:"text-end"},Xe={class:"flex-1 flex-col text-center"},Ze={class:"border-b-2 border-dashed mx-4 border-green-400 text-sm"},et={class:"text-sm"},tt={class:"flex-1 self-center"},lt={class:"grid grid-cols-2 pt-4"},ot={class:"flex-col text-end"},st={class:""},at={class:"px-6 pb-4"},nt={class:"bg-white pt-4 pr-4 pl-4 rounded-t-lg flex flex-col text-sm"},rt={class:"font-bold"},it={class:"flex pt-4"},dt={class:"flex font-normal"},ut={key:0,class:"underline text-yellow-600"},ct={key:1},_t={key:2,class:"underline text-yellow-600"},pt={key:3},mt={key:0,class:"flex pl-8 font-normal"},ht={class:"font-bold"},vt={class:"text-yellow-600 mr-2"},ft={key:0,class:"underline text-yellow-600"},gt={key:1},yt={key:2,class:"underline text-yellow-600"},bt={key:3},xt={class:"font-bold pt-2 text-yellow-600"},kt={class:"flex space-x-4"},wt={class:"font-bold pt-2 text-yellow-600"},Bt={class:"flex space-x-4"},$t={class:"flex"},Tt={class:"flex py-2"},Ht={class:"flex items-center"},Dt={class:"flex items-center pr-4"},Mt={class:"text-yellow-600"},Rt={key:0,class:"flex py-2 px-6"},Ut={class:"flex items-center"},Pt={class:"text-yellow-600 mr-2"},Yt={class:"flex items-center pr-4"},Ft={class:"text-yellow-600"},Ct={class:"flex-col"},Nt={class:"flex pt-2"},At={class:"flex-none pr-6"},St=["placeholder"],Vt={class:"flex py-4 content-center"},Ot={class:"flex-none pr-2"},zt=["placeholder"],jt={class:"flex bg-white pt-6 rounded-b-lg mb-12"},Et={class:"flex-1 border-r-2 border-t-2 rounded flex justify-center"},Kt={class:"flex-1 border-t-2 rounded flex justify-center"},Xt=ve({__name:"[id]",setup(It){const ee=fe(),V=ge(),{t:p}=q(),R=ee.params.id,U=m(""),P=m(""),B=m(),Y=m(""),$=m(),F=m(""),x=m(""),k=m(""),O=c(()=>{const l=w.value.adult;return Math.min(l,2)*150+Math.max(l-2,0)*100});c(()=>O.value-Number(o.totalprice));const{locale:te}=q(),d=m(!1),z=()=>{d.value=!d.value};m("");const j=m(""),le={"zh-CN":$e,"zh-TW":Z,"en-US":Te},f=c(()=>le[te.value]||Z),E=l=>l&&l.isBefore(b().add(1,"day").startOf("day")),K=()=>Array.from({length:24},(l,t)=>t).filter(l=>l<8||l>18),I=l=>l===8?Array.from({length:60},(t,u)=>u).filter(t=>t<30):l===18?Array.from({length:60},(t,u)=>u).filter(t=>t>=1):[],T=()=>{const l=b(j.value,"HH:mm").hour();return Array.from({length:24},(t,u)=>u).filter(t=>t<l||t>18)},H=l=>{const t=b(j.value,"HH:mm").minute();return l===8?Array.from({length:60},(u,h)=>h).filter(u=>u<30):l===19?Array.from({length:60},(u,h)=>h).filter(u=>u>=1):Array.from({length:60},(u,h)=>h).filter(u=>u<t)},oe=c(()=>d.value?o.destination_loc:o.departure_loc),se=c(()=>d.value?o.departure_loc:o.destination_loc),ae=c(()=>d.value?o.return_destination:o.return_departure),ne=c(()=>d.value?o.return_departure:o.return_destination),re=async l=>{try{await $fetch("/api/DeleteBookingById/"+l,{method:"DELETE"}),alert(p("alertMessage5")),V.push("/")}catch{alert(p("alertMessage6"))}},ie=async()=>{try{const l={departure_loc:oe.value,destination_loc:se.value,return_departure:ae.value,return_destination:ne.value,shuttle_date:B.value?B.value.format("YYYY-MM-DD"):o.shuttle_date,shuttle_time:Y.value||o.shuttle_time,return_shuttle_date:$.value?$.value.format("YYYY-MM-DD"):o.return_shuttle_date,return_shuttle_time:F.value||o.return_shuttle_time,ferry_time:x.value||o.ferry_time,flight_time:k.value||o.flight_time,adult_num:w.value.adult||o.adult_num,child_num:w.value.child||o.child_num,contact_phone:U.value||o.contact_phone,contact_name:P.value||o.contact_name,totalprice:O.value||o.totalprice};await $fetch("/api/detailsUpdate/"+R,{method:"PUT",body:l}),alert(p("alertMessage7")),V.push("/")}catch(l){console.error("Update failed:",l),alert(p("alertMessage8"))}},o=ye({trip_type:"",user_id:"",adult_num:"",child_num:"",contact_phone:"",totalprice:"",contact_name:"",departure_loc:"",destination_loc:"",return_departure:"",return_destination:"",arrivalpoint_date:"",arrivalpoint_time:"",flight_num:"",ferry_time:"",flight_time:"",shuttle_date:b(),shuttle_time:"",return_shuttle_date:b(),return_shuttle_time:""}),C=c(()=>p(o.departure_loc||"defaultKey")),N=c(()=>p(o.destination_loc||"defaultKey")),A=c(()=>p(o.return_departure||"defaultKey")),S=c(()=>p(o.return_destination||"defaultKey")),de=async()=>{try{const t=(await $fetch(`/api/reschedulePage/details/${R}`)).data;Object.assign(o,{trip_type:t.trip_type,user_id:t.user_id,adult_num:t.adult_num,child_num:t.child_num,contact_phone:t.contact_phone,totalprice:t.totalprice,contact_name:t.contact_name,departure_loc:t.departure_loc,destination_loc:t.destination_loc,return_departure:t.return_departure,return_destination:t.return_destination,arrivalpoint_date:t.arrivalpoint_date,arrivalpoint_time:t.arrivalpoint_time,flight_num:t.flight_num,ferry_time:t.ferry_time,flight_time:t.flight_time,shuttle_date:t.shuttle_date,shuttle_time:t.shuttle_time,return_shuttle_date:t.return_shuttle_date,return_shuttle_time:t.return_shuttle_time}),w.value.adult=Number(o.adult_num)||0,w.value.child=Number(o.child_num)||0,console.log("form:",o)}catch(l){console.error("Error fetching booking:",l),alert("Get blog detail error")}},w=m({adult:0,child:0}),L=l=>l?b(l).format("YYYY-MM-DD"):"N/A",ue=c(()=>o.departure_loc==="Booking.pier"?o.flight_time:o.ferry_time),ce=c(()=>o.departure_loc==="Booking.pier"?p("Booking.flightTime"):p("Booking.ferryTime")),_e=c(()=>o.return_departure==="Booking.pier"?o.flight_time:o.ferry_time),pe=c(()=>o.return_departure==="Booking.pier"?p("Booking.flightTime"):p("Booking.ferryTime"));return be(de),(l,t)=>{const u=me,h=he,G=xe,W=ke,g=we,y=Be;return r(),_(J,null,[e("header",He,[e("div",null,[i(u)]),e("h1",De,s(l.$t("ReschedulePage.title")),1)]),e("div",Me,s(l.$t("ReschedulePage.message")),1),e("div",Re,[e("div",Ue,[e("div",Pe,[e("p",null,s(l.$t("ReschedulePage.originalSchedule")),1)]),e("div",Ye,[e("div",Fe,[e("div",Ce,[e("p",Ne,s(C.value),1)]),e("div",Ae,[e("div",Se,[e("p",null,s(L(n(o).shuttle_date)),1)]),e("div",Ve,[e("p",null,s(n(o).shuttle_time),1)])]),e("div",Oe,[e("p",null,s(N.value),1)])]),e("div",ze,[e("div",je,[e("p",null,s(ce.value),1),e("p",null,s(l.$t("Booking.contact")),1),e("p",null,s(l.$t("Booking.phone")),1),e("p",null,s(l.$t("Booking.adultTicket")),1),e("p",null,s(l.$t("Booking.childTicket")),1)]),e("div",Ee,[e("p",null,": "+s(ue.value),1),e("p",null,": "+s(n(o).contact_name),1),e("p",null,": "+s(n(o).contact_phone),1),e("p",null,": "+s(n(o).adult_num),1),e("p",null,": "+s(n(o).child_num),1)])])])]),n(o).trip_type==="roundTrip"?(r(),_("div",Ke,[e("div",Ie,[e("div",Le,[e("p",Ge,s(l.$t("Booking.return")),1)]),e("div",We,[e("div",qe,[e("div",Je,[e("p",Qe,s(A.value),1)]),e("div",Xe,[e("div",Ze,[e("p",null,s(L(n(o).return_shuttle_date)),1)]),e("div",et,[e("p",null,s(n(o).return_shuttle_time),1)])]),e("div",tt,[e("p",null,s(S.value),1)])]),e("div",lt,[e("div",ot,[e("p",null,s(pe.value),1),e("p",null,s(l.$t("Booking.contact")),1),e("p",null,s(l.$t("Booking.phone")),1),e("p",null,s(l.$t("Booking.adultTicket")),1),e("p",null,s(l.$t("Booking.childTicket")),1)]),e("div",st,[e("p",null,": "+s(_e.value),1),e("p",null,": "+s(n(o).contact_name),1),e("p",null,": "+s(n(o).contact_phone),1),e("p",null,": "+s(n(o).adult_num),1),e("p",null,": "+s(n(o).child_num),1)])])])])])):D("",!0)]),e("div",at,[e("div",nt,[e("div",rt,[e("p",null,s(l.$t("ReschedulePage.newSchedule")),1)]),e("div",it,[e("div",dt,[d.value?(r(),_("p",ut,s(N.value),1)):(r(),_("p",ct,s(C.value),1)),i(h,{name:"i-material-symbols:360",class:"mx-4 bg-green-600 w-5 h-5 cursor-pointer",onClick:z}),d.value?(r(),_("p",_t,s(C.value),1)):(r(),_("p",pt,s(N.value),1))]),n(o).trip_type==="roundTrip"?(r(),_("div",mt,[e("div",ht,[e("p",vt,s(l.$t("Booking.return"))+" :",1)]),d.value?(r(),_("p",ft,s(S.value),1)):(r(),_("p",gt,s(A.value),1)),i(h,{name:"i-material-symbols:360",class:"mx-4 bg-green-600 w-5 h-5 cursor-pointer",onClick:z}),d.value?(r(),_("p",yt,s(A.value),1)):(r(),_("p",bt,s(S.value),1))])):D("",!0)]),e("div",xt,[e("p",null,s(l.$t("ReschedulePage.departureTime")),1)]),i(y,{locale:f.value},{default:v(()=>[e("div",kt,[i(W,{direction:"vertical",size:12},{default:v(()=>[i(G,{"show-today":!1,"disabled-date":E,value:B.value,"onUpdate:value":t[0]||(t[0]=a=>B.value=a)},null,8,["value"])]),_:1}),i(g,{"minute-step":d.value?5:30,"value-format":"HH:mm",format:"HH:mm","disabled-hours":K,"disabled-minutes":I,"hide-disabled-options":!0,"show-now":!1,value:Y.value,"onUpdate:value":t[1]||(t[1]=a=>Y.value=a)},null,8,["minute-step","value"])])]),_:1},8,["locale"]),n(o).trip_type==="roundTrip"?(r(),_(J,{key:0},[e("div",wt,[e("p",null,s(l.$t("ReschedulePage.returnDepartureTime")),1)]),i(y,{locale:f.value},{default:v(()=>[e("div",Bt,[i(W,{direction:"vertical",size:12},{default:v(()=>[i(G,{"show-today":!1,"disabled-date":E,value:$.value,"onUpdate:value":t[2]||(t[2]=a=>$.value=a)},null,8,["value"])]),_:1}),i(g,{"minute-step":d.value?5:30,"value-format":"HH:mm",format:"HH:mm","disabled-hours":K,"disabled-minutes":I,"hide-disabled-options":!0,"show-now":!1,value:F.value,"onUpdate:value":t[3]||(t[3]=a=>F.value=a)},null,8,["minute-step","value"])])]),_:1},8,["locale"])],64)):D("",!0),e("div",$t,[e("div",Tt,[e("div",Ht,[e("div",Dt,[i(h,{name:"lucide:tickets",class:"bg-yellow-600 w-6 h-6"}),e("p",Mt,s(d.value?l.$t("Booking.ferryTime"):l.$t("Booking.flightTime")),1)]),e("div",null,[d.value?(r(),M(y,{key:0,locale:f.value},{default:v(()=>[i(g,{value:x.value,"onUpdate:value":t[4]||(t[4]=a=>x.value=a),"minute-step":30,"value-format":"HH:mm",format:"HH:mm","hide-disabled-options":!0,"show-now":!1,"disabled-hours":T,"disabled-minutes":H},null,8,["value"])]),_:1},8,["locale"])):(r(),M(y,{key:1,locale:f.value},{default:v(()=>[i(g,{"minute-step":5,"value-format":"HH:mm",format:"HH:mm","hide-disabled-options":!0,"show-now":!1,"disabled-hours":T,"disabled-minutes":H,value:k.value,"onUpdate:value":t[5]||(t[5]=a=>k.value=a)},null,8,["value"])]),_:1},8,["locale"]))])])]),n(o).trip_type==="roundTrip"?(r(),_("div",Rt,[e("div",Ut,[e("p",Pt,s(l.$t("Booking.return"))+" :",1),e("div",Yt,[i(h,{name:"lucide:tickets",class:"bg-yellow-600 w-6 h-6"}),e("p",Ft,s(d.value?l.$t("Booking.flightTime"):l.$t("Booking.ferryTime")),1)]),e("div",null,[d.value?(r(),M(y,{key:0,locale:f.value},{default:v(()=>[i(g,{"minute-step":5,"value-format":"HH:mm",format:"HH:mm","hide-disabled-options":!0,"show-now":!1,"disabled-hours":T,"disabled-minutes":H,value:k.value,"onUpdate:value":t[6]||(t[6]=a=>k.value=a)},null,8,["value"])]),_:1},8,["locale"])):(r(),M(y,{key:1,locale:f.value},{default:v(()=>[i(g,{value:x.value,"onUpdate:value":t[7]||(t[7]=a=>x.value=a),"minute-step":30,"value-format":"HH:mm",format:"HH:mm","hide-disabled-options":!0,"show-now":!1,"disabled-hours":T,"disabled-minutes":H},null,8,["value"])]),_:1},8,["locale"]))])])])):D("",!0)]),e("div",Ct,[e("div",Nt,[e("p",At,s(l.$t("Booking.contact")),1),Q(e("input",{type:"text",placeholder:n(o).contact_name,"onUpdate:modelValue":t[8]||(t[8]=a=>P.value=a),class:"flex-1 px-4 border-b-2 border-gray-600 bg-inherit focus:outline-none text-sm min-w-0"},null,8,St),[[X,P.value]])]),e("div",Vt,[e("p",Ot,s(l.$t("Booking.phone")),1),Q(e("input",{type:"text",placeholder:n(o).contact_phone,"onUpdate:modelValue":t[9]||(t[9]=a=>U.value=a),class:"flex-1 px-4 border-b-2 border-gray-600 bg-inherit focus:outline-none text-sm min-w-0"},null,8,zt),[[X,U.value]])])])]),e("div",jt,[e("div",Et,[e("button",{onClick:ie,class:"text-blue-400 py-2 rounded"},s(l.$t("ReschedulePage.confirmReschedule")),1)]),e("div",Kt,[e("button",{onClick:t[10]||(t[10]=()=>re(n(R))),class:"text-red-500 py-2 rounded"},s(l.$t("cancelOrder")),1)])])])],64)}}});export{Xt as default};
